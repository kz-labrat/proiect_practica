const dateAdmitere = {
  informatica: [
    {
      universitate: "UAIC - InformaticÄƒ",
      oras: "IaÈ™i, RomÃ¢nia",
      buget: 8.50,
      taxa: 7.80,
      link: "https://www.info.uaic.ro",
      maps: "https://www.google.com/maps?q=Universitatea+Alexandru+Ioan+Cuza+IaÈ™i"
    },
    {
      universitate: "TUIASI - Calculatoare",
      oras: "IaÈ™i, RomÃ¢nia",
      buget: 8.70,
      taxa: 7.90,
      link: "https://www.ac.tuiasi.ro",
      maps: "https://www.google.com/maps?q=Universitatea+TehnicÄƒ+Gheorghe+Asachi+IaÈ™i"
    },
    {
      universitate: "USV - InformaticÄƒ",
      oras: "Suceava, RomÃ¢nia",
      buget: 8.20,
      taxa: 7.40,
      link: "https://www.eed.usv.ro",
      maps: "https://www.google.com/maps?q=Universitatea+È˜tefan+cel+Mare+Suceava"
    },
    {
      universitate: "UGAL - InformaticÄƒ",
      oras: "GalaÈ›i, RomÃ¢nia",
      buget: 8.00,
      taxa: 7.20,
      link: "https://www.ugal.ro",
      maps: "https://www.google.com/maps?q=Universitatea+DunÄƒrea+de+Jos+din+GalaÈ›i"
    },
    {
      universitate: "UBc - InformaticÄƒ",
      oras: "BacÄƒu, RomÃ¢nia",
      buget: 7.90,
      taxa: 7.00,
      link: "https://www.ub.ro",
      maps: "https://www.google.com/maps?q=Universitatea+Vasile+Alecsandri+din+BacÄƒu"
    },
    {
      universitate: "Universitatea Petre Andrei",
      oras: "IaÈ™i, RomÃ¢nia",
      buget: 7.80,
      taxa: 6.80,
      link: "https://upa.ro",
      maps: "https://www.google.com/maps?q=Universitatea+Petre+Andrei+IaÈ™i"
    },
    {
      universitate: "UTM - Universitatea TehnicÄƒ a Moldovei",
      oras: "ChiÈ™inÄƒu, Moldova",
      buget: 8.00,
      taxa: 7.00,
      link: "https://utm.md",
      maps: "https://www.google.com/maps?q=Universitatea+TehnicÄƒ+a+Moldovei+ChiÈ™inÄƒu"
    },
    {
      universitate: "USM - Universitatea de Stat din Moldova",
      oras: "ChiÈ™inÄƒu, Moldova",
      buget: 8.30,
      taxa: 7.50,
      link: "https://usm.md",
      maps: "https://www.google.com/maps?q=Universitatea+de+Stat+din+Moldova+ChiÈ™inÄƒu"
    },
    {
      universitate: "Universitatea de Stat â€Alecu Russoâ€ din BÄƒlÈ›i",
      oras: "BÄƒlÈ›i, Moldova",
      buget: 7.80,
      taxa: 7.00,
      link: "https://usarb.md",
      maps: "https://www.google.com/maps?q=Universitatea+de+Stat+Alecu+Russo+din+BÄƒlÈ›i"
    },
    {
      universitate: "Universitatea de Studii Europene",
      oras: "ChiÈ™inÄƒu, Moldova",
      buget: 7.50,
      taxa: 6.80,
      link: "https://usem.md",
      maps: "https://www.google.com/maps?q=Universitatea+de+Studii+Europene+ChiÈ™inÄƒu"
    }
  ],

  medicina: [
    {
      universitate: "UMF IaÈ™i",
      oras: "IaÈ™i, RomÃ¢nia",
      buget: 9.40,
      taxa: 8.60,
      link: "https://www.umfiasi.ro",
      maps: "https://www.google.com/maps?q=Universitatea+de+MedicinÄƒ+È™i+Farmacie+IaÈ™i"
    },
    {
      universitate: "UMFST TÃ¢rgu MureÈ™ - extensie BacÄƒu",
      oras: "BacÄƒu, RomÃ¢nia",
      buget: 9.10,
      taxa: 8.30,
      link: "https://www.umfst.ro",
      maps: "https://www.google.com/maps?q=UMFST+TÃ¢rgu+MureÈ™+extensie+BacÄƒu"
    },
    {
      universitate: "USMF â€Nicolae TestemiÈ›anuâ€",
      oras: "ChiÈ™inÄƒu, Moldova",
      buget: 9.20,
      taxa: 8.50,
      link: "https://usmf.md",
      maps: "https://www.google.com/maps?q=Universitatea+de+Stat+de+MedicinÄƒ+È™i+Farmacie+Nicolae+TestemiÈ›anu"
    }
  ],

  drept: [
    {
      universitate: "UAIC - Drept",
      oras: "IaÈ™i, RomÃ¢nia",
      buget: 8.70,
      taxa: 7.90,
      link: "https://www.laws.uaic.ro",
      maps: "https://www.google.com/maps?q=Facultatea+de+Drept+UAIC+IaÈ™i"
    },
    {
      universitate: "UGAL - Drept",
      oras: "GalaÈ›i, RomÃ¢nia",
      buget: 8.10,
      taxa: 7.30,
      link: "https://www.ugal.ro",
      maps: "https://www.google.com/maps?q=Facultatea+de+Drept+UGAL+GalaÈ›i"
    },
    {
      universitate: "USV - Drept",
      oras: "Suceava, RomÃ¢nia",
      buget: 8.00,
      taxa: 7.20,
      link: "https://www.usv.ro",
      maps: "https://www.google.com/maps?q=Facultatea+de+Drept+USV+Suceava"
    },
    {
      universitate: "USM - Drept",
      oras: "ChiÈ™inÄƒu, Moldova",
      buget: 8.50,
      taxa: 7.70,
      link: "https://usm.md",
      maps: "https://www.google.com/maps?q=Facultatea+de+Drept+USM+ChiÈ™inÄƒu"
    },
    {
      universitate: "ULIM - Facultatea de Drept",
      oras: "ChiÈ™inÄƒu, Moldova",
      buget: 8.10,
      taxa: 7.20,
      link: "https://ulim.md",
      maps: "https://www.google.com/maps?q=ULIM+Facultatea+de+Drept+ChiÈ™inÄƒu"
    }
  ]
};

  function calculeazaAdmiterea() {
  // Get grades from localStorage
  const grades = JSON.parse(localStorage.getItem('grades') || '{}');
  const domeniu = document.getElementById("domeniu").value;
  const tara = document.getElementById("tara").value;
  const rezultateDiv = document.getElementById("rezultate");

  // Helper: fallback to 0 if not present
  const g = n => typeof grades[n] === "number" ? grades[n] : 0;

  // Define formulas for each university (by name)
const formule = {
  "UTM - Universitatea TehnicÄƒ a Moldovei": {
    calc: g =>
      0.10 * g("matematica") +
      0.10 * g("informatica") +
      0.10 * g("fizica") +
      0.10 * g("engleza") +
      0.20 * g("anual") +
      0.20 * g("examen") +
      0.20 * g("bac"),
    descriere: "10% MatematicÄƒ + 10% InformaticÄƒ + 10% FizicÄƒ + 10% EnglezÄƒ + 20% Media anualÄƒ + 20% Examen + 20% BAC"
  },
  "UAIC - InformaticÄƒ": {
    calc: g =>
      0.25 * g("matematica") +
      0.25 * g("informatica") +
      0.10 * g("romana") +
      0.10 * g("engleza") +
      0.10 * g("fizica") +
      0.10 * g("anual") +
      0.10 * g("examen") +
      0.10 * g("bac"),
    descriere: "25% MatematicÄƒ + 25% InformaticÄƒ + 10% RomÃ¢nÄƒ + 10% EnglezÄƒ + 10% FizicÄƒ + 10% Media anualÄƒ + 10% Examen + 10% BAC"
  },
  "TUIASI - Calculatoare": {
    calc: g =>
      0.30 * g("matematica") +
      0.20 * g("informatica") +
      0.10 * g("romana") +
      0.10 * g("engleza") +
      0.10 * g("anual") +
      0.10 * g("examen") +
      0.10 * g("bac"),
    descriere: "30% MatematicÄƒ + 20% InformaticÄƒ + 10% RomÃ¢nÄƒ + 10% EnglezÄƒ + 10% Media anualÄƒ + 10% Examen + 10% BAC"
  },
  "USV - InformaticÄƒ": {
    calc: g =>
      0.25 * g("matematica") +
      0.25 * g("informatica") +
      0.10 * g("romana") +
      0.10 * g("engleza") +
      0.10 * g("anual") +
      0.10 * g("examen") +
      0.10 * g("bac"),
    descriere: "25% MatematicÄƒ + 25% InformaticÄƒ + 10% RomÃ¢nÄƒ + 10% EnglezÄƒ + 10% Media anualÄƒ + 10% Examen + 10% BAC"
  },
  "UGAL - InformaticÄƒ": {
    calc: g =>
      0.25 * g("matematica") +
      0.25 * g("informatica") +
      0.10 * g("romana") +
      0.10 * g("fizica") +
      0.10 * g("anual") +
      0.10 * g("examen") +
      0.10 * g("bac"),
    descriere: "25% MatematicÄƒ + 25% InformaticÄƒ + 10% RomÃ¢nÄƒ + 10% FizicÄƒ + 10% Media anualÄƒ + 10% Examen + 10% BAC"
  },
  "UBc - InformaticÄƒ": {
    calc: g =>
      0.25 * g("matematica") +
      0.25 * g("informatica") +
      0.10 * g("romana") +
      0.10 * g("engleza") +
      0.10 * g("anual") +
      0.10 * g("examen") +
      0.10 * g("bac"),
    descriere: "25% MatematicÄƒ + 25% InformaticÄƒ + 10% RomÃ¢nÄƒ + 10% EnglezÄƒ + 10% Media anualÄƒ + 10% Examen + 10% BAC"
  },
  "Universitatea Petre Andrei": {
    calc: g =>
      0.20 * g("matematica") +
      0.20 * g("informatica") +
      0.10 * g("romana") +
      0.10 * g("engleza") +
      0.10 * g("anual") +
      0.10 * g("examen") +
      0.20 * g("bac"),
    descriere: "20% MatematicÄƒ + 20% InformaticÄƒ + 10% RomÃ¢nÄƒ + 10% EnglezÄƒ + 10% Media anualÄƒ + 10% Examen + 20% BAC"
  },
  "USM - Universitatea de Stat din Moldova": {
    calc: g =>
      0.20 * g("matematica") +
      0.20 * g("informatica") +
      0.10 * g("romana") +
      0.10 * g("fizica") +
      0.10 * g("anual") +
      0.10 * g("examen") +
      0.20 * g("bac"),
    descriere: "20% MatematicÄƒ + 20% InformaticÄƒ + 10% RomÃ¢nÄƒ + 10% FizicÄƒ + 10% Media anualÄƒ + 10% Examen + 20% BAC"
  },
  "Universitatea de Stat â€Alecu Russoâ€ din BÄƒlÈ›i": {
    calc: g =>
      0.20 * g("matematica") +
      0.20 * g("informatica") +
      0.10 * g("romana") +
      0.10 * g("engleza") +
      0.10 * g("anual") +
      0.10 * g("examen") +
      0.20 * g("bac"),
    descriere: "20% MatematicÄƒ + 20% InformaticÄƒ + 10% RomÃ¢nÄƒ + 10% EnglezÄƒ + 10% Media anualÄƒ + 10% Examen + 20% BAC"
  },
  "Universitatea de Studii Europene": {
    calc: g =>
      0.20 * g("matematica") +
      0.20 * g("informatica") +
      0.10 * g("romana") +
      0.10 * g("engleza") +
      0.10 * g("anual") +
      0.10 * g("examen") +
      0.20 * g("bac"),
    descriere: "20% MatematicÄƒ + 20% InformaticÄƒ + 10% RomÃ¢nÄƒ + 10% EnglezÄƒ + 10% Media anualÄƒ + 10% Examen + 20% BAC"
  },

  // MEDICINA
  "UMF IaÈ™i": {
    calc: g =>
      0.22 * g("chimie") +
      0.22 * g("biologie") +
      0.10 * g("romana") +
      0.10 * g("engleza") +
      0.10 * g("fizica") +
      0.08 * g("anual") +
      0.08 * g("examen") +
      0.10 * g("bac"),
    descriere: "22% Chimie + 22% Biologie + 10% RomÃ¢nÄƒ + 10% EnglezÄƒ + 10% FizicÄƒ + 8% Media anualÄƒ + 8% Examen + 10% BAC"
  },
  "UMFST TÃ¢rgu MureÈ™ - extensie BacÄƒu": {
    calc: g =>
      0.22 * g("chimie") +
      0.22 * g("biologie") +
      0.10 * g("romana") +
      0.10 * g("engleza") +
      0.10 * g("fizica") +
      0.08 * g("anual") +
      0.08 * g("examen") +
      0.10 * g("bac"),
    descriere: "22% Chimie + 22% Biologie + 10% RomÃ¢nÄƒ + 10% EnglezÄƒ + 10% FizicÄƒ + 8% Media anualÄƒ + 8% Examen + 10% BAC"
  },
  "USMF â€Nicolae TestemiÈ›anuâ€": {
    calc: g =>
      0.22 * g("chimie") +
      0.22 * g("biologie") +
      0.10 * g("romana") +
      0.10 * g("engleza") +
      0.10 * g("fizica") +
      0.08 * g("anual") +
      0.08 * g("examen") +
      0.10 * g("bac"),
    descriere: "22% Chimie + 22% Biologie + 10% RomÃ¢nÄƒ + 10% EnglezÄƒ + 10% FizicÄƒ + 8% Media anualÄƒ + 8% Examen + 10% BAC"
  },

  // DREPT
  "UAIC - Drept": {
    calc: g =>
      0.30 * g("istorie") +
      0.30 * g("romana") +
      0.10 * g("engleza") +
      0.10 * g("anual") +
      0.10 * g("examen") +
      0.10 * g("bac"),
    descriere: "30% Istorie + 30% RomÃ¢nÄƒ + 10% EnglezÄƒ + 10% Media anualÄƒ + 10% Examen + 10% BAC"
  },
  "UGAL - Drept": {
    calc: g =>
      0.30 * g("istorie") +
      0.30 * g("romana") +
      0.10 * g("engleza") +
      0.10 * g("anual") +
      0.10 * g("examen") +
      0.10 * g("bac"),
    descriere: "30% Istorie + 30% RomÃ¢nÄƒ + 10% EnglezÄƒ + 10% Media anualÄƒ + 10% Examen + 10% BAC"
  },
  "USV - Drept": {
    calc: g =>
      0.30 * g("istorie") +
      0.30 * g("romana") +
      0.10 * g("engleza") +
      0.10 * g("anual") +
      0.10 * g("examen") +
      0.10 * g("bac"),
    descriere: "30% Istorie + 30% RomÃ¢nÄƒ + 10% EnglezÄƒ + 10% Media anualÄƒ + 10% Examen + 10% BAC"
  },
  "USM - Drept": {
    calc: g =>
      0.30 * g("istorie") +
      0.30 * g("romana") +
      0.10 * g("engleza") +
      0.10 * g("anual") +
      0.10 * g("examen") +
      0.10 * g("bac"),
    descriere: "30% Istorie + 30% RomÃ¢nÄƒ + 10% EnglezÄƒ + 10% Media anualÄƒ + 10% Examen + 10% BAC"
  },
  "ULIM - Facultatea de Drept": {
    calc: g =>
      0.30 * g("istorie") +
      0.30 * g("romana") +
      0.10 * g("engleza") +
      0.10 * g("anual") +
      0.10 * g("examen") +
      0.10 * g("bac"),
    descriere: "30% Istorie + 30% RomÃ¢nÄƒ + 10% EnglezÄƒ + 10% Media anualÄƒ + 10% Examen + 10% BAC"
  }
};


  // Filter and map results
  const rezultate = dateAdmitere[domeniu]
  .filter(fac => {
    if (tara === "toate") return true;
    if (tara === "romania") return fac.oras.includes("RomÃ¢nia");
    if (tara === "moldova") return fac.oras.includes("Moldova");
  })
  .map(fac => {
    let medie, formulaText;
    if (formule[fac.universitate]) {
      medie = formule[fac.universitate].calc(n => g(n));
      formulaText = formule[fac.universitate].descriere;
    } else {
      medie = g("bac");
      formulaText = "Doar media BAC";
    }

    let mesaj = "";
    if (medie >= fac.buget)
      mesaj = `<span style='color:green;'>buget</span>`;
    else if (medie >= fac.taxa)
      mesaj = `<span style='color:orange;'>taxÄƒ</span>`;
    else
      mesaj = `<span style='color:red;'>Media insuficientÄƒ</span>`;

    return `
      <div style="margin-bottom:20px; padding: 10px; border: 1px solid #ccc; border-radius: 8px;">
        <strong>${fac.universitate}</strong> â€“ ${fac.oras}<br>
        <span style="font-size:0.95em;color:#888;">Formula: ${formulaText}</span><br>
        Media ta calculatÄƒ: <b>${medie.toFixed(2)}</b><br>
        PoÈ›i intra la: ${mesaj}<br>
        <a href="${fac.link}" target="_blank">ğŸ”— ViziteazÄƒ site-ul oficial</a><br>
        <div class="map-container">
          <a href="${fac.maps}" target="_blank">ğŸ“ Vezi locaÈ›ia pe Google Maps</a>
          <div class="map-preview">
            <iframe
              src="${fac.maps.replace("https://www.google.com/maps?q=", "https://maps.google.com/maps?q=")}&output=embed"
              loading="lazy"
              referrerpolicy="no-referrer-when-downgrade">
            </iframe>
          </div>
        </div>
      </div>
    `;
  }).join("");

  rezultateDiv.innerHTML = `<h3>Rezultate posibile:</h3>${rezultate}`;
}